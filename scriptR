#TRABAJO EN R DE ANALISIS DE DATOS#
#JAVIER ESPINOZA#
#----------------------------------#
#LIBRERIAS#
library(Peptides)
library(readr)
library(base)
library(stats)
library(utils)
library(graphics)
library(MASS)
library(Rlab)
library(xlsx)
library(ggplot2)
library(psych)
library(writexl)
library(readxl)
library(forcats)

#generacion datos a partir de read_xlsx#
Datos<-read_xlsx("calcR.xlsx")

#analisis de datos por medio de peptides#
aIndex(seq = caract$DIGESTION)
aIndex(seq = "MAS")
fasgaiVectors(seq = caract$DIGESTION)
write.table(aIndex(seq = caract$DIGESTION), file = "caract.xlsx", append = TRUE, col.names = NA, row.names = TRUE)
ai<- data.frame(aIndex(seq = caract$DIGESTION),row.names = NULL, check.rows = FALSE, check.names = TRUE)
head(ai)
write.table( ai, file = "caract.xlsx")
write.csv(ai, file = "caract")
install.packages("writexl")
write_xlsx(ai, path = caract)
write_xlsx(ai, path = "caract")
write.csv2(ai, "ai.csv")
bo<- data.frame(boman(seq = caract$DIGESTION),row.names = NULL, check.rows = FALSE, check.names = TRUE)
write.csv2(bo, "bo.csv")
cha<- data.frame(charge(caract$DIGESTION, pH= 7, pKscale = "Sillero"),row.names = NULL, check.rows = FALSE, check.names = TRUE)
write.csv2(cha, "cha.csv")
cru<- data.frame(crucianiProperties(seq = caract$DIGESTION),row.names = NULL, check.rows = FALSE, check.names = TRUE)
write.csv2(cru, "cru.csv")
fas<- data.frame(fasgaiVectors(seq = caract$DIGESTION),row.names = NULL, check.rows = FALSE, check.names = TRUE)
write.csv2(fas, "fas.csv")
hi<- data.frame(hydrophobicity(seq = caract$DIGESTION, scale = "Kidera"),row.names = NULL, check.rows = FALSE, check.names = TRUE)
write.csv2(hi, "hi.csv")
mw<- data.frame(mw(seq = caract$DIGESTION, monoisotopic = FALSE),row.names = NULL, check.rows = FALSE, check.names = TRUE)
write.csv2(mw, "mw.csv")
pi<- data.frame(pI(seq = caract$DIGESTION, pKscale = "Murray"),row.names = NULL, check.rows = FALSE, check.names = TRUE)
write.csv2(pi, "pi.csv")
boman(seq = caract$DIGESTION)
aIndex(seq = caract$DIGESTION)

#lectura y analisís de la tabla creada con los datos obtenidos#
summary(calcR)

#transformación de formato para set de datos "CRYO" de caracter a factor#
calcR$CRYO<-as.factor(calcR$CRYO)

#continuacion de analisís de datos#
summary(calcR)

#HISTOGRAMAS#

ggplot(calcR, aes(x= NCH, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity") + labs(title = "Carga Neta")
ggplot(calcR, aes(x= IP, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity") +labs(title = "Punto Isoelectrico")
ggplot(calcR, aes(x= MW, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity") +labs(title = "Peso Molecular")
ggplot(calcR, aes(x= AI, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity") +labs(title = "Indice Alifatico")
ggplot(calcR, aes(x= BI, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity") +labs(title = "Indice de Boman")
ggplot(calcR, aes(x= HIPH, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity") +labs(title = "Hidrofobicidad")
ggplot(calcR, aes(x= CRU1, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity") +labs(title = "Polaridad Cruciani")
ggplot(calcR, aes(x= CRU2, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity") +labs(title = "Hidrofobicidad Cruciani")
ggplot(calcR, aes(x= CRU3, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity") +labs(title = "H-Bonding")
ggplot(calcR, aes(x= FAS1, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity") +labs(title = "Hidrofobicidad de Fasgai")
ggplot(calcR, aes(x= FAS4, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity") +labs(title = "Indice de Composición")
ggplot(calcR, aes(x= FAS5, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity") +labs(title = "Flexibilidad Local")
ggplot(calcR, aes(x= FAS6, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity") +labs(title = "Propiedades Electronicas")

#BOXPLOTS#

ggplot(calcR, aes(x=CRYO, y=NCH, fill=CRYO)) + geom_boxplot() +labs(title = "Carga Neta")
ggplot(calcR, aes(x=CRYO, y=IP, fill=CRYO)) + geom_boxplot() +labs(title = "Punto isoelevtrico")
ggplot(calcR, aes(x=CRYO, y=MW, fill=CRYO)) + geom_boxplot() +labs(title = "Peso Molecular")
ggplot(calcR, aes(x=CRYO, y=AI, fill=CRYO)) + geom_boxplot() +labs(title = "Indice Alifatico")
ggplot(calcR, aes(x=CRYO, y=BI, fill=CRYO)) + geom_boxplot() +labs(title = "Indice de Boman")
ggplot(calcR, aes(x=CRYO, y=HIPH, fill=CRYO)) + geom_boxplot() +labs(title = "Hidrofobicidad")
ggplot(calcR, aes(x=CRYO, y=CRU1, fill=CRYO)) + geom_boxplot() +labs(title = "Polaridad Cruciani")
ggplot(calcR, aes(x=CRYO, y=CRU2, fill=CRYO)) + geom_boxplot() +labs(title = "Hidrofobicidad Cruciani")
ggplot(calcR, aes(x=CRYO, y=CRU3, fill=CRYO)) + geom_boxplot() +labs(title = "H-Bonding")
ggplot(calcR, aes(x=CRYO, y=FAS1, fill=CRYO)) + geom_boxplot() +labs(title = "Hidrofobicidad Fasgai")
ggplot(calcR, aes(x=CRYO, y=FAS4, fill=CRYO)) + geom_boxplot() +labs(title = "Indice Camposición")
ggplot(calcR, aes(x=CRYO, y=FAS5, fill=CRYO)) + geom_boxplot() +labs(title = "Flexibilidad Local")
ggplot(calcR, aes(x=CRYO, y=FAS6, fill=CRYO)) + geom_boxplot() +labs(title = "Propiedades Electronicas")

#TRABAJO EN R DE ANALISIS DE DATOS#
#JAVIER ESPINOZA#
#----------------------------------#
#LIBRERIAS#
library(Peptides)
library(readr)
library(base)
library(stats)
library(utils)
library(graphics)
library(MASS)
library(Rlab)
library(xlsx)
library(ggplot2)
library(psych)
library(writexl)
library(readxl)
#generacion datos a partir de read_xlsx#
Datos<-read_xlsx("calcR.xlsx")
#analisis de datos por medio de peptides#
aIndex(seq = caract$DIGESTION)
aIndex(seq = "MAS")
fasgaiVectors(seq = caract$DIGESTION)
write.table(aIndex(seq = caract$DIGESTION), file = "caract.xlsx", append = TRUE, col.names = NA, row.names = TRUE)
ai<- data.frame(aIndex(seq = caract$DIGESTION),row.names = NULL, check.rows = FALSE, check.names = TRUE)
head(ai)
write.table( ai, file = "caract.xlsx")
write.csv(ai, file = "caract")
install.packages("writexl")
write_xlsx(ai, path = caract)
write_xlsx(ai, path = "caract")
write.csv2(ai, "ai.csv")
bo<- data.frame(boman(seq = caract$DIGESTION),row.names = NULL, check.rows = FALSE, check.names = TRUE)
write.csv2(bo, "bo.csv")
cha<- data.frame(charge(caract$DIGESTION, pH= 7, pKscale = "Sillero"),row.names = NULL, check.rows = FALSE, check.names = TRUE)
write.csv2(cha, "cha.csv")
cru<- data.frame(crucianiProperties(seq = caract$DIGESTION),row.names = NULL, check.rows = FALSE, check.names = TRUE)
write.csv2(cru, "cru.csv")
fas<- data.frame(fasgaiVectors(seq = caract$DIGESTION),row.names = NULL, check.rows = FALSE, check.names = TRUE)
write.csv2(fas, "fas.csv")
hi<- data.frame(hydrophobicity(seq = caract$DIGESTION, scale = "Kidera"),row.names = NULL, check.rows = FALSE, check.names = TRUE)
write.csv2(hi, "hi.csv")
mw<- data.frame(mw(seq = caract$DIGESTION, monoisotopic = FALSE),row.names = NULL, check.rows = FALSE, check.names = TRUE)
write.csv2(mw, "mw.csv")
pi<- data.frame(pI(seq = caract$DIGESTION, pKscale = "Murray"),row.names = NULL, check.rows = FALSE, check.names = TRUE)
write.csv2(pi, "pi.csv")
boman(seq = caract$DIGESTION)
aIndex(seq = caract$DIGESTION)
#lectura y analisís de la tabla creada con los datos obtenidos#
summary(calcR)
#transformación de formato para set de datos "CRYO" de caracter a factor#
calcR$CRYO<-as.factor(calcR$CRYO)
#continuacion de analisís de datos#
summary(calcR)
#ejemplo de anotacion en ggplot con titulo subtitulo y anotacion inferior#
#NCHCRYO<- ggplot(calcR, aes(x= NCH, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity")#
#NCHCRYO<-NCHCRYO + labs(title = "Net Charge", subtitle = "carga neta", caption = "fuente: mis calculos")#
#print(NCHCRYO)#


#HISTOGRAMAS#

#PRUEBA CON FUNCION par()#
#ESTO FUNCIONA PERO NO DIFERENCIA ENTRE "AFP" y "NO AFP"#
par(mfrow = c(1, 2))
hist(calcR$NCH, main = "Carga neta", xlab = "Carga neta")
hist(calcR$IP, main = "Punto Isoelectrico", xlab = "Punto Isoelectrico")

#ESTO TIRA ERROR#
#Error in hist.default(., calcR$NCH, main = "Carga neta", xlab = "Carga neta") :
#some 'x' not counted; maybe 'breaks' do not span range of 'x'

calcR%>%filter(calcR$CRYO == "AFP") %>% hist(calcR$NCH, main = "Carga neta", xlab = "Carga neta")

#ESTO NO FUNCIONA#
par(mfrow = c(1, 2))
ggplot(calcR, aes(x= NCH, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity")+ labs(title = "Carga Neta")
ggplot(calcR, aes(x= IP, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity")+ labs(title = "Punto Isoelectrico")

#CONSTRUCCION DE OBJETOS PARA INTENTAR EXPORTAR MAS DE UNO EN UN MISMO JPEG#
#TAMPOCO FUNCIONÓ#

NCHCRYO<- ggplot(calcR, aes(x= NCH, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity")
NCHCRYO<-NCHCRYO + labs(title = "Carga Neta")
IPCRYO<-ggplot(calcR, aes(x= IP, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity")
IPCRYO<-IPCRYO +labs(title = "Punto Isoelectrico")
MWCRYO<- ggplot(calcR, aes(x= MW, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity")
MWCRYO<-MWCRYO+labs(title = "Peso Molecular")
AICRYO<-ggplot(calcR, aes(x= AI, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity")
AICRYO<-AICRYO+labs(title = "Indice Alifatico")
BICRYO<-ggplot(calcR, aes(x= BI, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity")
BICRYO<-BICRYO+labs(title = "Indice de Boman")
HICRYO<-ggplot(calcR, aes(x= HIPH, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity")
HICRYO<-HICRYO+labs(title = "Hidrofobicidad")
cru1cryo<-ggplot(calcR, aes(x= CRU1, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity")
cru1cryo<-cru1cryo+labs(title = "Polaridad Cruciani")
cru2cryo<-ggplot(calcR, aes(x= CRU2, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity")
cru2cryo<-cru2cryo+labs(title = "Hidrofobicidad Cruciani")
cru3cryo<-ggplot(calcR, aes(x= CRU3, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity")
cru3cryo<-cru3cryo+labs(title = "H-Bonding")
fas1cryo<-ggplot(calcR, aes(x= FAS1, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity")
fas1cryo<-fas1cryo+labs(title = "Hidrofobicidad de Fasgai")
fas4cryo<-ggplot(calcR, aes(x= FAS4, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity")
fas4cryo<-fas4cryo+labs(title = "Indice de Composición")
fas5cryo<-ggplot(calcR, aes(x= FAS5, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity")
fas5cryo<-fas5cryo+labs(title = "Flexibilidad Local")
fas6cryo<-ggplot(calcR, aes(x= FAS6, color= CRYO)) + geom_histogram(bins = 20, alpha=0.50, position = "identity")
fas6cryo<-fas6cryo+labs(title = "Propiedades Electronicas")

#BOXPLOTS#

B1<-ggplot(calcR, aes(x=CRYO, y=NCH, fill=CRYO)) + geom_boxplot()
B1<-B1+labs(title = "Carga Neta")
B2<-ggplot(calcR, aes(x=CRYO, y=IP, fill=CRYO)) + geom_boxplot()
B2<-B2+labs(title = "Punto isoelevtrico")
B3<-ggplot(calcR, aes(x=CRYO, y=MW, fill=CRYO)) + geom_boxplot()
B3<-B3+labs(title = "Peso Molecular")
B4<-ggplot(calcR, aes(x=CRYO, y=AI, fill=CRYO)) + geom_boxplot()
B4<-B4+labs(title = "Indice Alifatico")
B5<-ggplot(calcR, aes(x=CRYO, y=BI, fill=CRYO)) + geom_boxplot()
B5<-B5+labs(title = "Indice de Boman")
B6<-ggplot(calcR, aes(x=CRYO, y=HIPH, fill=CRYO)) + geom_boxplot()
B6<-B6+labs(title = "Hidrofobicidad")
B7<-ggplot(calcR, aes(x=CRYO, y=CRU1, fill=CRYO)) + geom_boxplot()
B7<-B7+labs(title = "Polaridad Cruciani")
B8<-ggplot(calcR, aes(x=CRYO, y=CRU2, fill=CRYO)) + geom_boxplot()
B8<-B8+labs(title = "Hidrofobicidad Cruciani")
B9<-ggplot(calcR, aes(x=CRYO, y=CRU3, fill=CRYO)) + geom_boxplot()
B9<-B9+labs(title = "H-Bonding")
B10<-ggplot(calcR, aes(x=CRYO, y=FAS1, fill=CRYO)) + geom_boxplot()
B10<-B10+labs(title = "Hidrofobicidad Fasgai")
B11<-ggplot(calcR, aes(x=CRYO, y=FAS4, fill=CRYO)) + geom_boxplot()
B11<-B11+labs(title = "Indice Camposición")
B12<-ggplot(calcR, aes(x=CRYO, y=FAS5, fill=CRYO)) + geom_boxplot()
B12<-B12+labs(title = "Flexibilidad Local")
B13<-ggplot(calcR, aes(x=CRYO, y=FAS6, fill=CRYO)) + geom_boxplot()
B13<-B13+labs(title = "Propiedades Electronicas")

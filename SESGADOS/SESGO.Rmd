---
title: "Sesgo"
author: "Javier espinoza"
date: '2022-06-12'
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# ANALISÍS DE SESGO 

## Librerias usadas

```{r Librerias, echo=TRUE, message=FALSE, warning=FALSE}
library(Peptides)
library (seqinr)
library(tidyverse)
library(cluster)
library(factoextra)
library(pheatmap)
library(readxl)
library(stats)
```

# 4 clusters

## Leer archivo fuente, este es un excel, cambie un poco el codigo para usar lo que se

```{r}
Lista_calculo4 <- read_excel("C:/Users/javeb/Documents/R/TESIS/SESGADOS/CLUSTER_4.xlsx")
View(Lista_calculo4)
```

## Ahora a obtener los descriptores, verlo y guardarlos en un archivo Excel

```{r echo=TRUE}
peptideDescriptors4 <- data.frame(
  Name = unlist(Lista_calculo4$Name),
  sequence = unlist(Lista_calculo4$Sequence),
  aIndex = aIndex(Lista_calculo4$Sequence),
  boman = boman(Lista_calculo4$Sequence),
  charge = charge(Lista_calculo4$Sequence, pH = 7, pKscale = "Sillero"),
  crucianiProperties = do.call(rbind.data.frame, crucianiProperties(Lista_calculo4$Sequence)),
  fasgaiVectors = do.call(rbind.data.frame, fasgaiVectors(Lista_calculo4$Sequence)),
  hydrophobicity = hydrophobicity(Lista_calculo4$Sequence, scale="Kidera"),
  pI = pI(Lista_calculo4$Sequence, pKscale="EMBOSS"),mw = mw(Lista_calculo4$Sequence))
colnames(peptideDescriptors4) <- c('Name','sequence', "aIndex", "Boman", "Charge", paste0('PP', 1:3), paste0('F', 1:6), "Hidrophobicity","pI", "MW")
view(peptideDescriptors4)
Tabla = subset(peptideDescriptors4, select = -c(sequence))
knitr::kable(Tabla, caption = "**Tabla 1.** Descriptores")
write.csv2(peptideDescriptors4, "Descriptores4.csv")      
```

## Quito primera y segunda fila y exploratorio de datos

```{r}
datapep4= subset(peptideDescriptors4, select = -c(Name, sequence))
view(datapep4)
boxplot(datapep4)
summary(datapep4)
```

## Normalizar y ver cambios

```{r message=TRUE, warning=TRUE}
pepscale4 = scale(datapep4)
summary(pepscale4)
boxplot(pepscale4)
```

## Calculo PCAs y obtención de archivo Excel de rotación

```{r include=FALSE}
PCApep4 = prcomp(pepscale4)
summary(PCApep4)
## write.csv2(PCApep4, "PCApep4.csv") ##
```

## Para escoger el numero de PCAs

```{r}
stdev4= PCApep4$sdev
pr_var4 = stdev4^2
pr_var4[1:15] 
prop_varex4 =pr_var4/sum(pr_var4)
prop_varex4[1:15]
plot(prop_varex4, xlab = "Principal Component",ylab = "Proportion of Variance Explained",type = "b")
plot(cumsum(prop_varex4), xlab = "Principal Component",ylab = "Cumulative Proportion of Variance Explained",type = "b")

```

## Determinar numero optimo de clusters por medio del metodo de "avarage silhouette"

```{r}
fviz_nbclust(PCApep4$x[ ,1:15],kmeans,method = "silhouette", k.max = 30, iter.max=25)

```

## Graficar heatmap 

## Heatmap de 4 clusters
```{r}
cluster4pep= pheatmap(PCApep4$x[,1:5], kmeans_k = 4,cluster_cols = FALSE, treeheight_row = 150, cellwidth = 15, color = colorRampPalette(c("blue", "white", "red"))(50),main = "Peptide Clustering Analysis 4" )

write.csv2 (cluster4pep$kmeans$cluster, file="clustermemberS4pep.csv")
```

# 5 clusters

## Leer archivo fuente, este es un excel, cambie un poco el codigo para usar lo que se

```{r}
Lista_calculo5 <- read_excel("C:/Users/javeb/Documents/R/TESIS/SESGADOS/CLUSTER_5.xlsx")
View(Lista_calculo5)
```

## Ahora a obtener los descriptores, verlo y guardarlos en un archivo Excel

```{r echo=TRUE}
peptideDescriptors5 <- data.frame(
  Name = unlist(Lista_calculo5$Name),
  sequence = unlist(Lista_calculo5$Sequence),
  aIndex = aIndex(Lista_calculo5$Sequence),
  boman = boman(Lista_calculo5$Sequence),
  charge = charge(Lista_calculo5$Sequence, pH = 7, pKscale = "Sillero"),
  crucianiProperties = do.call(rbind.data.frame, crucianiProperties(Lista_calculo5$Sequence)),
  fasgaiVectors = do.call(rbind.data.frame, fasgaiVectors(Lista_calculo5$Sequence)),
  hydrophobicity = hydrophobicity(Lista_calculo5$Sequence, scale="Kidera"),
  pI = pI(Lista_calculo5$Sequence, pKscale="EMBOSS"),mw = mw(Lista_calculo5$Sequence))
colnames(peptideDescriptors5) <- c('Name','sequence', "aIndex", "Boman", "Charge", paste0('PP', 1:3), paste0('F', 1:6), "Hidrophobicity","pI", "MW")
view(peptideDescriptors5)
Tabla = subset(peptideDescriptors5, select = -c(sequence))
knitr::kable(Tabla, caption = "**Tabla 1.** Descriptores")
write.csv2(peptideDescriptors5, "Descriptores5.csv")      
```

## Quito primera y segunda fila y exploratorio de datos

```{r}
datapep5= subset(peptideDescriptors5, select = -c(Name, sequence))
view(datapep5)
boxplot(datapep5)
summary(datapep5)
```

## Normalizar y ver cambios

```{r}
pepscale5 = scale(datapep5)
summary(pepscale5)
boxplot(pepscale5)
```

## Calculo PCAs y obtención de archivo Excel de rotación

```{r}
PCApep5 = prcomp(pepscale5)
summary(PCApep5)
##write.csv2(PCApep5, "PCApep5.csv")##
```

## Para escoger el numero de PCAs

```{r}
stdev5= PCApep5$sdev
pr_var5 = stdev5^2
pr_var5[1:15] 
prop_varex5 =pr_var5/sum(pr_var5)
prop_varex5[1:15]
plot(prop_varex5, xlab = "Principal Component",ylab = "Proportion of Variance Explained",type = "b")
plot(cumsum(prop_varex5), xlab = "Principal Component",ylab = "Cumulative Proportion of Variance Explained",type = "b")

```

## Determinar numero optimo de clusters por medio del metodo de "avarage silhouette"

```{r}
fviz_nbclust(PCApep5$x[ ,1:15],kmeans,method = "silhouette", k.max = 30, iter.max=25)

```

## Graficar heatmap 

## Heatmap de 5 clusters
```{r}
cluster5pep= pheatmap(PCApep5$x[,1:5], kmeans_k = 5,cluster_cols = FALSE, treeheight_row = 150, cellwidth = 15, color = colorRampPalette(c("blue", "white", "red"))(50),main = "Peptide Clustering Analysis 5" )

write.csv2 (cluster5pep$kmeans$cluster, file="clustermemberS5pep.csv")
```

# 6 clusters

## Leer archivo fuente, este es un excel, cambie un poco el codigo para usar lo que se

```{r}
Lista_calculo6 <- read_excel("C:/Users/javeb/Documents/R/TESIS/SESGADOS/CLUSTER_6.xlsx")
View(Lista_calculo6)
```

## Ahora a obtener los descriptores, verlo y guardarlos en un archivo Excel

```{r echo=TRUE}
peptideDescriptors6 <- data.frame(
  Name = unlist(Lista_calculo6$Name),
  sequence = unlist(Lista_calculo6$Sequence),
  aIndex = aIndex(Lista_calculo6$Sequence),
  boman = boman(Lista_calculo6$Sequence),
  charge = charge(Lista_calculo6$Sequence, pH = 7, pKscale = "Sillero"),
  crucianiProperties = do.call(rbind.data.frame, crucianiProperties(Lista_calculo6$Sequence)),
  fasgaiVectors = do.call(rbind.data.frame, fasgaiVectors(Lista_calculo6$Sequence)),
  hydrophobicity = hydrophobicity(Lista_calculo6$Sequence, scale="Kidera"),
  pI = pI(Lista_calculo6$Sequence, pKscale="EMBOSS"),mw = mw(Lista_calculo6$Sequence))
colnames(peptideDescriptors6) <- c('Name','sequence', "aIndex", "Boman", "Charge", paste0('PP', 1:3), paste0('F', 1:6), "Hidrophobicity","pI", "MW")
view(peptideDescriptors6)
Tabla = subset(peptideDescriptors6, select = -c(sequence))
knitr::kable(Tabla, caption = "**Tabla 1.** Descriptores")
write.csv2(peptideDescriptors6, "Descriptores6.csv")      
```

## Quito primera y segunda fila y exploratorio de datos

```{r}
datapep6= subset(peptideDescriptors6, select = -c(Name, sequence))
view(datapep6)
boxplot(datapep6)
summary(datapep6)
```

## Normalizar y ver cambios

```{r}
pepscale6 = scale(datapep6)
summary(pepscale6)
boxplot(pepscale6)
```

## Calculo PCAs y obtención de archivo Excel de rotación

```{r}
PCApep6 = prcomp(pepscale6)
summary(PCApep6)
##write.csv2(PCApep6, "PCApep6.csv")##
```

## Para escoger el numero de PCAs

```{r}
stdev6= PCApep6$sdev
pr_var6 = stdev6^2
pr_var6[1:15] 
prop_varex6 =pr_var6/sum(pr_var6)
prop_varex6[1:15]
plot(prop_varex6, xlab = "Principal Component",ylab = "Proportion of Variance Explained",type = "b")
plot(cumsum(prop_varex6), xlab = "Principal Component",ylab = "Cumulative Proportion of Variance Explained",type = "b")

```

## Determinar numero optimo de clusters por medio del metodo de "avarage silhouette"

```{r}
fviz_nbclust(PCApep6$x[ ,1:15],kmeans,method = "silhouette", k.max = 30, iter.max=25)

```

## Graficar heatmap 

## Heatmap de 6 clusters
```{r}
cluster6pep= pheatmap(PCApep6$x[,1:5], kmeans_k = 6,cluster_cols = FALSE, treeheight_row = 150, cellwidth = 15, color = colorRampPalette(c("blue", "white", "red"))(50),main = "Peptide Clustering Analysis 6" )

write.csv2 (cluster6pep$kmeans$cluster, file="clustermemberS6pep.csv")
```

# 7 clusters

## Leer archivo fuente, este es un excel, cambie un poco el codigo para usar lo que se

```{r}
Lista_calculo7 <- read_excel("C:/Users/javeb/Documents/R/TESIS/SESGADOS/CLUSTER_7.xlsx")
View(Lista_calculo7)
```

## Ahora a obtener los descriptores, verlo y guardarlos en un archivo Excel

```{r echo=TRUE}
peptideDescriptors7 <- data.frame(
  Name = unlist(Lista_calculo7$Name),
  sequence = unlist(Lista_calculo7$Sequence),
  aIndex = aIndex(Lista_calculo7$Sequence),
  boman = boman(Lista_calculo7$Sequence),
  charge = charge(Lista_calculo7$Sequence, pH = 7, pKscale = "Sillero"),
  crucianiProperties = do.call(rbind.data.frame, crucianiProperties(Lista_calculo7$Sequence)),
  fasgaiVectors = do.call(rbind.data.frame, fasgaiVectors(Lista_calculo7$Sequence)),
  hydrophobicity = hydrophobicity(Lista_calculo7$Sequence, scale="Kidera"),
  pI = pI(Lista_calculo7$Sequence, pKscale="EMBOSS"),mw = mw(Lista_calculo7$Sequence))
colnames(peptideDescriptors7) <- c('Name','sequence', "aIndex", "Boman", "Charge", paste0('PP', 1:3), paste0('F', 1:6), "Hidrophobicity","pI", "MW")
view(peptideDescriptors7)
Tabla = subset(peptideDescriptors7, select = -c(sequence))
knitr::kable(Tabla, caption = "**Tabla 1.** Descriptores")
write.csv2(peptideDescriptors7, "Descriptores7.csv")      
```

## Quito primera y segunda fila y exploratorio de datos

```{r}
datapep7= subset(peptideDescriptors7, select = -c(Name, sequence))
view(datapep7)
boxplot(datapep7)
summary(datapep7)
```

## Normalizar y ver cambios

```{r}
pepscale7 = scale(datapep7)
summary(pepscale7)
boxplot(pepscale7)
```

## Calculo PCAs y obtención de archivo Excel de rotación

```{r}
PCApep7 = prcomp(pepscale7)
summary(PCApep7)
##write.csv2(PCApep7, "PCApep7.csv")##
```

## Para escoger el numero de PCAs

```{r}
stdev7= PCApep7$sdev
pr_var7 = stdev7^2
pr_var7[1:15] 
prop_varex7 =pr_var7/sum(pr_var7)
prop_varex7[1:15]
plot(prop_varex7, xlab = "Principal Component",ylab = "Proportion of Variance Explained",type = "b")
plot(cumsum(prop_varex7), xlab = "Principal Component",ylab = "Cumulative Proportion of Variance Explained",type = "b")

```

## Determinar numero optimo de clusters por medio del metodo de "avarage silhouette"

```{r}
fviz_nbclust(PCApep7$x[ ,1:15],kmeans,method = "silhouette", k.max = 30, iter.max=25)

```

## Graficar heatmap 

## Heatmap de 7 clusters
```{r}
cluster7pep= pheatmap(PCApep7$x[,1:5], kmeans_k = 8,cluster_cols = FALSE, treeheight_row = 150, cellwidth = 15, color = colorRampPalette(c("blue", "white", "red"))(50),main = "Peptide Clustering Analysis 7" )

write.csv2 (cluster7pep$kmeans$cluster, file="clustermemberS7pep.csv")
```

# 8 clusters

## Leer archivo fuente, este es un excel, cambie un poco el codigo para usar lo que se

```{r}
Lista_calculo8 <- read_excel("C:/Users/javeb/Documents/R/TESIS/SESGADOS/CLUSTER_8.xlsx")
View(Lista_calculo8)
```

## Ahora a obtener los descriptores, verlo y guardarlos en un archivo Excel

```{r echo=TRUE}
peptideDescriptors8 <- data.frame(
  Name = unlist(Lista_calculo8$Name),
  sequence = unlist(Lista_calculo8$Sequence),
  aIndex = aIndex(Lista_calculo8$Sequence),
  boman = boman(Lista_calculo8$Sequence),
  charge = charge(Lista_calculo8$Sequence, pH = 7, pKscale = "Sillero"),
  crucianiProperties = do.call(rbind.data.frame, crucianiProperties(Lista_calculo8$Sequence)),
  fasgaiVectors = do.call(rbind.data.frame, fasgaiVectors(Lista_calculo8$Sequence)),
  hydrophobicity = hydrophobicity(Lista_calculo8$Sequence, scale="Kidera"),
  pI = pI(Lista_calculo8$Sequence, pKscale="EMBOSS"),mw = mw(Lista_calculo8$Sequence))
colnames(peptideDescriptors8) <- c('Name','sequence', "aIndex", "Boman", "Charge", paste0('PP', 1:3), paste0('F', 1:6), "Hidrophobicity","pI", "MW")
view(peptideDescriptors8)
Tabla = subset(peptideDescriptors8, select = -c(sequence))
knitr::kable(Tabla, caption = "**Tabla 1.** Descriptores")
write.csv2(peptideDescriptors8, "Descriptores8.csv")      
```

## Quito primera y segunda fila y exploratorio de datos

```{r}
datapep8= subset(peptideDescriptors8, select = -c(Name, sequence))
view(datapep8)
boxplot(datapep8)
summary(datapep8)
```

## Normalizar y ver cambios

```{r}
pepscale8 = scale(datapep8)
summary(pepscale8)
boxplot(pepscale8)
```

## Calculo PCAs y obtención de archivo Excel de rotación

```{r}
PCApep8 = prcomp(pepscale8)
summary(PCApep8)
##write.csv2(PCApep8, "PCApep8.csv")##
```

## Para escoger el numero de PCAs

```{r}
stdev8= PCApep8$sdev
pr_var8 = stdev8^2
pr_var8[1:15] 
prop_varex8 =pr_var8/sum(pr_var8)
prop_varex8[1:15]
plot(prop_varex8, xlab = "Principal Component",ylab = "Proportion of Variance Explained",type = "b")
plot(cumsum(prop_varex8), xlab = "Principal Component",ylab = "Cumulative Proportion of Variance Explained",type = "b")

```

## Determinar numero optimo de clusters por medio del metodo de "avarage silhouette"

```{r}
fviz_nbclust(PCApep8$x[ ,1:15],kmeans,method = "silhouette", k.max = 30, iter.max=25)

```

## Graficar heatmap 

## Heatmap de 8 clusters
```{r}
cluster8pep= pheatmap(PCApep8$x[,1:5], kmeans_k = 8,cluster_cols = FALSE, treeheight_row = 150, cellwidth = 15, color = colorRampPalette(c("blue", "white", "red"))(50),main = "Peptide Clustering Analysis 8" )

write.csv2 (cluster8pep$kmeans$cluster, file="clustermemberS8pep.csv")
```

# 9 clusters

## Leer archivo fuente, este es un excel, cambie un poco el codigo para usar lo que se

```{r}
Lista_calculo9 <- read_excel("C:/Users/javeb/Documents/R/TESIS/SESGADOS/CLUSTER_9.xlsx")
View(Lista_calculo9)
```

## Ahora a obtener los descriptores, verlo y guardarlos en un archivo Excel

```{r echo=TRUE}
peptideDescriptors9 <- data.frame(
  Name = unlist(Lista_calculo9$Name),
  sequence = unlist(Lista_calculo9$Sequence),
  aIndex = aIndex(Lista_calculo9$Sequence),
  boman = boman(Lista_calculo9$Sequence),
  charge = charge(Lista_calculo9$Sequence, pH = 7, pKscale = "Sillero"),
  crucianiProperties = do.call(rbind.data.frame, crucianiProperties(Lista_calculo9$Sequence)),
  fasgaiVectors = do.call(rbind.data.frame, fasgaiVectors(Lista_calculo9$Sequence)),
  hydrophobicity = hydrophobicity(Lista_calculo9$Sequence, scale="Kidera"),
  pI = pI(Lista_calculo9$Sequence, pKscale="EMBOSS"),mw = mw(Lista_calculo9$Sequence))
colnames(peptideDescriptors9) <- c('Name','sequence', "aIndex", "Boman", "Charge", paste0('PP', 1:3), paste0('F', 1:6), "Hidrophobicity","pI", "MW")
view(peptideDescriptors9)
Tabla = subset(peptideDescriptors9, select = -c(sequence))
knitr::kable(Tabla, caption = "**Tabla 1.** Descriptores")
write.csv2(peptideDescriptors9, "Descriptores9.csv")      
```

## Quito primera y segunda fila y exploratorio de datos

```{r}
datapep9= subset(peptideDescriptors9, select = -c(Name, sequence))
view(datapep9)
boxplot(datapep9)
summary(datapep9)
```

## Normalizar y ver cambios

```{r}
pepscale9 = scale(datapep9)
summary(pepscale9)
boxplot(pepscale9)
```

## Calculo PCAs y obtención de archivo Excel de rotación

```{r}
PCApep9 = prcomp(pepscale9)
summary(PCApep9)
##write.csv2(PCApep9, "PCApep9.csv")##
```

## Para escoger el numero de PCAs

```{r}
stdev9= PCApep9$sdev
pr_var9 = stdev9^2
pr_var9[1:15] 
prop_varex9 =pr_var9/sum(pr_var9)
prop_varex9[1:15]
plot(prop_varex9, xlab = "Principal Component",ylab = "Proportion of Variance Explained",type = "b")
plot(cumsum(prop_varex9), xlab = "Principal Component",ylab = "Cumulative Proportion of Variance Explained",type = "b")

```

## Determinar numero optimo de clusters por medio del metodo de "avarage silhouette"

```{r}
fviz_nbclust(PCApep9$x[ ,1:15],kmeans,method = "silhouette", k.max = 30, iter.max=25)

```

## Graficar heatmap 

## Heatmap de 9 clusters
```{r}
cluster9pep= pheatmap(PCApep9$x[,1:5], kmeans_k = 9,cluster_cols = FALSE, treeheight_row = 150, cellwidth = 15, color = colorRampPalette(c("blue", "white", "red"))(50),main = "Peptide Clustering Analysis 9" )

write.csv2 (cluster9pep$kmeans$cluster, file="clustermemberS9pep.csv")
```

# 10 clusters

## Leer archivo fuente, este es un excel, cambie un poco el codigo para usar lo que se

```{r}
Lista_calculo10 <- read_excel("C:/Users/javeb/Documents/R/TESIS/SESGADOS/CLUSTER_10.xlsx")
View(Lista_calculo10)
```

## Ahora a obtener los descriptores, verlo y guardarlos en un archivo Excel

```{r echo=TRUE}
peptideDescriptors10 <- data.frame(
  Name = unlist(Lista_calculo10$Name),
  sequence = unlist(Lista_calculo10$Sequence),
  aIndex = aIndex(Lista_calculo10$Sequence),
  boman = boman(Lista_calculo10$Sequence),
  charge = charge(Lista_calculo10$Sequence, pH = 7, pKscale = "Sillero"),
  crucianiProperties = do.call(rbind.data.frame, crucianiProperties(Lista_calculo10$Sequence)),
  fasgaiVectors = do.call(rbind.data.frame, fasgaiVectors(Lista_calculo10$Sequence)),
  hydrophobicity = hydrophobicity(Lista_calculo10$Sequence, scale="Kidera"),
  pI = pI(Lista_calculo10$Sequence, pKscale="EMBOSS"),mw = mw(Lista_calculo10$Sequence))
colnames(peptideDescriptors10) <- c('Name','sequence', "aIndex", "Boman", "Charge", paste0('PP', 1:3), paste0('F', 1:6), "Hidrophobicity","pI", "MW")
view(peptideDescriptors10)
Tabla = subset(peptideDescriptors10, select = -c(sequence))
knitr::kable(Tabla, caption = "**Tabla 1.** Descriptores")
write.csv2(peptideDescriptors10, "Descriptores10.csv")      
```

## Quito primera y segunda fila y exploratorio de datos

```{r}
datapep10= subset(peptideDescriptors10, select = -c(Name, sequence))
view(datapep10)
boxplot(datapep10)
summary(datapep10)
```

## Normalizar y ver cambios

```{r}
pepscale10 = scale(datapep10)
summary(pepscale10)
boxplot(pepscale10)
```

## Calculo PCAs y obtención de archivo Excel de rotación

```{r}
PCApep10 = prcomp(pepscale10)
summary(PCApep10)
##write.csv2(PCApep10, "PCApep10.csv")##
```

## Para escoger el numero de PCAs

```{r}
stdev10= PCApep10$sdev
pr_var10 = stdev10^2
pr_var10[1:15] 
prop_varex10 =pr_var10/sum(pr_var10)
prop_varex10[1:15]
plot(prop_varex10, xlab = "Principal Component",ylab = "Proportion of Variance Explained",type = "b")
plot(cumsum(prop_varex10), xlab = "Principal Component",ylab = "Cumulative Proportion of Variance Explained",type = "b")

```

## Determinar numero optimo de clusters por medio del metodo de "avarage silhouette"

```{r}
fviz_nbclust(PCApep10$x[ ,1:15],kmeans,method = "silhouette", k.max = 30, iter.max=25)

```

## Graficar heatmap 

## Heatmap de 10 clusters
```{r}
cluster10pep= pheatmap(PCApep10$x[,1:5], kmeans_k = 10,cluster_cols = FALSE, treeheight_row = 150, cellwidth = 15, color = colorRampPalette(c("blue", "white", "red"))(50),main = "Peptide Clustering Analysis 10" )

write.csv2 (cluster10pep$kmeans$cluster, file="clustermemberS10pep.csv")
```

# 11 clusters

## Leer archivo fuente, este es un excel, cambie un poco el codigo para usar lo que se

```{r}
Lista_calculo11 <- read_excel("C:/Users/javeb/Documents/R/TESIS/SESGADOS/CLUSTER_11.xlsx")
View(Lista_calculo11)
```

## Ahora a obtener los descriptores, verlo y guardarlos en un archivo Excel

```{r echo=TRUE}
peptideDescriptors11 <- data.frame(
  Name = unlist(Lista_calculo11$Name),
  sequence = unlist(Lista_calculo11$Sequence),
  aIndex = aIndex(Lista_calculo11$Sequence),
  boman = boman(Lista_calculo11$Sequence),
  charge = charge(Lista_calculo11$Sequence, pH = 7, pKscale = "Sillero"),
  crucianiProperties = do.call(rbind.data.frame, crucianiProperties(Lista_calculo11$Sequence)),
  fasgaiVectors = do.call(rbind.data.frame, fasgaiVectors(Lista_calculo11$Sequence)),
  hydrophobicity = hydrophobicity(Lista_calculo11$Sequence, scale="Kidera"),
  pI = pI(Lista_calculo11$Sequence, pKscale="EMBOSS"),mw = mw(Lista_calculo11$Sequence))
colnames(peptideDescriptors11) <- c('Name','sequence', "aIndex", "Boman", "Charge", paste0('PP', 1:3), paste0('F', 1:6), "Hidrophobicity","pI", "MW")
view(peptideDescriptors11)
Tabla = subset(peptideDescriptors11, select = -c(sequence))
knitr::kable(Tabla, caption = "**Tabla 1.** Descriptores")
write.csv2(peptideDescriptors11, "Descriptores11.csv")      
```

## Quito primera y segunda fila y exploratorio de datos

```{r}
datapep11= subset(peptideDescriptors11, select = -c(Name, sequence))
view(datapep11)
boxplot(datapep11)
summary(datapep11)
```

## Normalizar y ver cambios

```{r}
pepscale11 = scale(datapep11)
summary(pepscale11)
boxplot(pepscale11)
```

## Calculo PCAs y obtención de archivo Excel de rotación

```{r}
PCApep11 = prcomp(pepscale11)
summary(PCApep11)
##write.csv2(PCApep11, "PCApep11.csv")##
```

## Para escoger el numero de PCAs

```{r}
stdev11= PCApep11$sdev
pr_var11 = stdev11^2
pr_var11[1:15] 
prop_varex11 =pr_var11/sum(pr_var11)
prop_varex11[1:15]
plot(prop_varex11, xlab = "Principal Component",ylab = "Proportion of Variance Explained",type = "b")
plot(cumsum(prop_varex11), xlab = "Principal Component",ylab = "Cumulative Proportion of Variance Explained",type = "b")

```

## Determinar numero optimo de clusters por medio del metodo de "avarage silhouette"

```{r}
fviz_nbclust(PCApep11$x[ ,1:15],kmeans,method = "silhouette", k.max = 30, iter.max=25)

```

## Graficar heatmap 

## Heatmap de 11 clusters
```{r}
cluster11pep= pheatmap(PCApep11$x[,1:5], kmeans_k = 11,cluster_cols = FALSE, treeheight_row = 150, cellwidth = 15, color = colorRampPalette(c("blue", "white", "red"))(50),main = "Peptide Clustering Analysis 11" )

write.csv2 (cluster11pep$kmeans$cluster, file="clustermemberS11pep.csv")
```

